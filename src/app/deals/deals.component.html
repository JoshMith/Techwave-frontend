<!-- Header Navigation -->
<header class="header">
    <nav class="nav-container">
        <a routerLink="/" class="logo">
            <img routerLink="/" src="favicon.ico" width="50px" alt="Logo">
        </a>
        <div class="nav-items">

            <a routerLink="/" class="nav-link">Home</a>
            <a routerLink="/shop" class="nav-link">Shop</a>
            <div class="dropdown">
                <a class="nav-link dropdown-trigger">
                    Categories
                    <svg class="dropdown-arrow" width="16" height="16" viewBox="0 0 24 24" fill="none"
                        xmlns="http://www.w3.org/2000/svg">
                        <path d="M6 9L12 15L18 9" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                            stroke-linejoin="round" />
                    </svg>
                </a>
                <div class="dropdown-menu">
                    <a routerLink="/categories/Phones" class="dropdown-link">
                        <svg class="dropdown-icon" width="20" height="20" viewBox="0 0 24 24" fill="none"
                            xmlns="http://www.w3.org/2000/svg">
                            <rect x="5" y="2" width="14" height="20" rx="2" ry="2" stroke="currentColor"
                                stroke-width="2" />
                            <line x1="12" y1="18" x2="12.01" y2="18" stroke="currentColor" stroke-width="2"
                                stroke-linecap="round" stroke-linejoin="round" />
                        </svg>
                        Phones
                    </a>
                    <a routerLink="/categories/Laptops" class="dropdown-link">
                        <svg class="dropdown-icon" width="20" height="20" viewBox="0 0 24 24" fill="none"
                            xmlns="http://www.w3.org/2000/svg">
                            <rect x="2" y="4" width="20" height="12" rx="2" ry="2" stroke="currentColor"
                                stroke-width="2" />
                            <line x1="2" y1="20" x2="22" y2="20" stroke="currentColor" stroke-width="2" />
                        </svg>
                        Laptops
                    </a>
                    <a routerLink="/categories/Accessories" class="dropdown-link">
                        <svg class="dropdown-icon" width="20" height="20" viewBox="0 0 24 24" fill="none"
                            xmlns="http://www.w3.org/2000/svg">
                            <path d="M3 18V15C3 13.3431 4.34315 12 6 12C7.65686 12 9 13.3431 9 15V18"
                                stroke="currentColor" stroke-width="2" />
                            <path d="M21 18V15C21 13.3431 19.6569 12 18 12C16.3431 12 15 13.3431 15 15V18"
                                stroke="currentColor" stroke-width="2" />
                            <path
                                d="M9 9C9 6.79086 10.7909 5 13 5H11C8.79086 5 7 6.79086 7 9V12H15V9C15 6.79086 16.2091 5 18.5 5H16.5C14.2909 5 12.5 6.79086 12.5 9"
                                stroke="currentColor" stroke-width="2" />
                        </svg>
                        Accessories
                    </a>
                    <a routerLink="/categories/Home Appliances" class="dropdown-link">
                        <svg class="dropdown-icon" width="20" height="20" viewBox="0 0 24 24" fill="none"
                            xmlns="http://www.w3.org/2000/svg">
                            <rect x="3" y="3" width="18" height="18" rx="2" ry="2" stroke="currentColor"
                                stroke-width="2" />
                            <circle cx="12" cy="12" r="3" stroke="currentColor" stroke-width="2" />
                            <path d="M12 1V3" stroke="currentColor" stroke-width="2" />
                            <path d="M21 12H23" stroke="currentColor" stroke-width="2" />
                            <path d="M12 21V23" stroke="currentColor" stroke-width="2" />
                            <path d="M1 12H3" stroke="currentColor" stroke-width="2" />
                        </svg>
                        Home Appliances
                    </a>
                    <a routerLink="/categories/Gaming" class="dropdown-link">
                        <svg class="dropdown-icon" width="20" height="20" viewBox="0 0 24 24" fill="none"
                            xmlns="http://www.w3.org/2000/svg">
                            <rect x="2" y="6" width="20" height="12" rx="4" ry="4" stroke="currentColor"
                                stroke-width="2" />
                            <circle cx="8" cy="12" r="2" stroke="currentColor" stroke-width="2" />
                            <path d="M16 10L18 12L16 14" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                stroke-linejoin="round" />
                        </svg>
                        Gaming
                    </a>
                    <a routerLink="/categories/Audio & Sound" class="dropdown-link">
                        <svg class="dropdown-icon" width="20" height="20" viewBox="0 0 24 24" fill="none"
                            xmlns="http://www.w3.org/2000/svg">
                            <polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5" stroke="currentColor"
                                stroke-width="2" />
                            <path
                                d="M19.07 4.93C20.98 6.84 20.98 10.16 19.07 12.07M15.54 8.46C16.17 9.09 16.17 10.09 15.54 10.72"
                                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                        </svg>
                        Audio & Sound
                    </a>
                </div>
            </div>
            <a routerLink="/deals" class="nav-link">Deals</a>
            <a routerLink="/login" class="nav-link">Signup</a>
            <a routerLink="/profile" class="nav-link">Profile</a>
        </div>
        <div class="cart-icon-container">
            <button class="cart-icon" aria-label="Cart" (click)="goToCart()" title="Cart">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path
                        d="M6 2L3 6V20C3 20.5304 3.21071 21.0391 3.58579 21.4142C3.96086 21.7893 4.46957 22 5 22H19C19.5304 22 20.0391 21.7893 20.4142 21.4142C20.7893 21.0391 21 20.5304 21 20V6L18 2H6Z"
                        stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                    <path d="M3 6H21" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                    <path
                        d="M16 10C16 11.0609 15.5786 12.0783 14.8284 12.8284C14.0783 13.5786 13.0609 14 12 14C10.9391 14 9.92172 13.5786 9.17157 12.8284C8.42143 12.0783 8 11.0609 8 10"
                        stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                </svg>
                <span class="cart-count" *ngIf="cartCount > 0">{{ cartCount }}</span>
            </button>
        </div>
    </nav>
</header>

<main class="deals-container">
    <!-- Loading State -->
    <div *ngIf="loading" class="loading-container">
        <div class="loading-spinner"></div>
        <p>Loading amazing deals...</p>
    </div>

    <!-- Error State -->
    <div *ngIf="errorMessage && !loading" class="error-container">
        <p>{{ errorMessage }}</p>
        <button class="retry-btn" (click)="ngOnInit()">Retry</button>
    </div>

    <!-- Content -->
    <div *ngIf="!loading && !errorMessage">
        <!-- Hero Banner -->
        <section class="deals-hero">
            <div class="hero-content">
                <h1>Exclusive Deals & Special Offers</h1>
                <p>Limited-time discounts on premium electronics. Don't miss out!</p>
            </div>
            <div class="countdown-banner">
                <div class="countdown-item">
                    <span class="countdown-value">{{ countdown.days < 10 ? '0' + countdown.days : countdown.days
                            }}</span>
                            <span class="countdown-label">Days</span>
                </div>
                <div class="countdown-item">
                    <span class="countdown-value">{{ countdown.hours < 10 ? '0' + countdown.hours : countdown.hours
                            }}</span>
                            <span class="countdown-label">Hours</span>
                </div>
                <div class="countdown-item">
                    <span class="countdown-value">{{ countdown.minutes < 10 ? '0' + countdown.minutes :
                            countdown.minutes }}</span>
                            <span class="countdown-label">Minutes</span>
                </div>
                <div class="countdown-item">
                    <span class="countdown-value">{{ countdown.seconds < 10 ? '0' + countdown.seconds :
                            countdown.seconds }}</span>
                            <span class="countdown-label">Seconds</span>
                </div>
            </div>
        </section>

        <!-- Featured Deals -->
        <section class="featured-deals">
            <h2>Featured Deals</h2>
            <div class="deals-grid" *ngIf="featuredDeals.length > 0; else noFeaturedDeals">
                <div *ngFor="let deal of featuredDeals" class="featured-deal-card">
                    <div class="deal-badge">
                        <span class="discount">{{deal.discount}}% OFF</span>
                        <span class="expiration">Ends in {{daysRemaining(deal.expiration)}} days</span>
                    </div>
                    <div class="deal-content">
                        <div class="deal-image">
                            <div class="image-placeholder">{{deal.image}}</div>
                        </div>
                        <div class="deal-info">
                            <h3>{{deal.title}}</h3>
                            <p class="description">{{deal.description}}</p>
                            <div class="deal-meta">
                                <span class="category">{{deal.category}}</span>
                                <span class="products">{{deal.products}} products</span>
                            </div>
                            <button class="shop-now-btn" (click)="shopNow()">Shop Now</button>
                        </div>
                    </div>
                </div>
            </div>
            <ng-template #noFeaturedDeals>
                <p class="no-deals-message">No featured deals available at the moment. Check back soon!</p>
            </ng-template>
        </section>

        <!-- Deal Categories -->
        <section class="deal-categories">
            <h2>Browse Deals by Category</h2>
            <div class="categories-grid">
                <div *ngFor="let category of categories" class="category-card"
                    [class.active]="selectedCategory === category.name" (click)="filterDeals(category.name)">
                    <div class="category-icon">{{category.icon}}</div>
                    <h3>{{category.name}}</h3>
                    <p>{{category.count}} deals</p>
                </div>
            </div>
        </section>

        <!-- All Active Deals -->
        <section class="all-deals">
            <div class="section-header">
                <h2>All Active Deals</h2>
                <div class="results-count">
                    Showing {{filteredDeals.length}} deals
                </div>
            </div>

            <div class="deals-grid" *ngIf="filteredDeals.length > 0; else noDeals">
                <div *ngFor="let deal of filteredDeals" class="deal-card">
                    <div class="deal-badge">
                        <span class="discount">{{deal.discount}}% OFF</span>
                        <span class="expiration">Ends in {{daysRemaining(deal.expiration)}} days</span>
                    </div>
                    <div class="deal-image">
                        <div class="image-placeholder">{{deal.image}}</div>
                    </div>
                    <div class="deal-info">
                        <h3>{{deal.title}}</h3>
                        <p class="description">{{deal.description}}</p>
                        <div class="deal-meta">
                            <span class="category">{{deal.category}}</span>
                            <span class="products">{{deal.products}} products</span>
                        </div>
                        <button class="shop-now-btn" (click)="shopNow()">Shop Now</button>
                    </div>
                </div>
            </div>
            <ng-template #noDeals>
                <p class="no-deals-message">No deals available in this category. Try selecting a different category!</p>
            </ng-template>
        </section>

        <!-- Expiring Soon -->
        <section class="expiring-deals" *ngIf="expiringDeals.length > 0">
            <div class="section-header">
                <h2>Expiring Soon</h2>
                <div class="urgent-tag">Hurry!</div>
            </div>

            <div class="deals-grid">
                <div *ngFor="let deal of expiringDeals" class="deal-card urgent">
                    <div class="deal-badge">
                        <span class="discount">{{deal.discount}}% OFF</span>
                        <span class="expiration">Ends in {{daysRemaining(deal.expiration)}} days</span>
                    </div>
                    <div class="deal-image">
                        <div class="image-placeholder">{{deal.image}}</div>
                    </div>
                    <div class="deal-info">
                        <h3>{{deal.title}}</h3>
                        <p class="description">{{deal.description}}</p>
                        <div class="deal-meta">
                            <span class="category">{{deal.category}}</span>
                            <span class="products">{{deal.products}} products</span>
                        </div>
                        <button class="shop-now-btn" (click)="shopNow()">Shop Now</button>
                    </div>
                </div>
            </div>
        </section>
    </div>
</main>

<footer class="deals-footer">
    <div class="footer-content">
        <div class="footer-section">
            <h3>TechWave Kenya</h3>
            <p>Your trusted electronics partner in Nairobi and Meru</p>
            <div class="contact-info">
                <p>Email: techwaveelectronics4&#64;gmail.com</p>
                <p>Phone: +254 742 841406 / +254 741 677623</p>

                <div class="social-icons">
                    <p><a routerLink="https://wa.me/+254742841406" target="_blank"><i
                                class="fa-brands fa-whatsapp"></i></a>
                    </p>
                    <p><a routerLink="https://web.facebook.com/profile.php?id=61577689410885" target="_blank"><i
                                class="fa-brands fa-facebook-f"></i></a></p>
                    <p><a routerLink="http://instagram.com/techwave_.electronics/" target="_blank"><i
                                class="fa-brands fa-instagram"></i></a></p>
                    <p><a routerLink="https://www.tiktok.com/@_.techwave" target="_blank"><i
                                class="fa-brands fa-tiktok"></i></a></p>
                    <p><a routerLink="https://x.com/_techWave01" target="_blank"><i
                                class="fa-brands fa-x-twitter"></i></a>
                    </p>
                </div>
            </div>
        </div>
        <div class="footer-section">
            <h4>Quick Links</h4>
            <ul>
                <li><a routerLink="/">Home</a></li>
                <li><a routerLink="/shop">Shop</a></li>
                <li><a routerLink="/deals">Deals</a></li>
                <li><a routerLink="/contact">Contact Us</a></li>
            </ul>
        </div>
        <div class="footer-section">
            <h4>Deal Alerts</h4>
            <p>Subscribe to get notified about new deals</p>
            <div class="subscribe-form">
                <input type="email" placeholder="Your email address">
                <button>Subscribe</button>
            </div>
        </div>
        <div class="footer-section">
            <h4>We Accept</h4>
            <div class="payment-methods">
                <div class="payment-method">M-PESA</div>
                <div class="payment-method">VISA</div>
                <div class="payment-method">MasterCard</div>
            </div>
        </div>
    </div>
    <div class="copyright">
        &copy; 2025 TechWave Kenya. All rights reserved.
    </div>
</footer>